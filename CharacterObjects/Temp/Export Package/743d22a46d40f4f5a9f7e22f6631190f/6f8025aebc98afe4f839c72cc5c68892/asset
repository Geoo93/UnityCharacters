using UnityEngine;
using System.Collections;

public class FPSWalker : MonoBehaviour {

    float speed = 6.0f;
    float jumpSpeed = 8.0f;
    float gravity = 20.0f;

    public Vector3 moveDirection = Vector3.zero;
    public bool ISGROUNDED = false;
    public bool CANJUMP = true;

    CharacterController controller;
	
	public static bool IsMoving;
	public static Vector3 MoveDir;

    void Start()
    {
        controller = GetComponent<CharacterController>();
    }

    void Update()
    {
            if (ISGROUNDED) { CANJUMP = true; }
            else { CANJUMP = false; }

	        if (ISGROUNDED)
	        {
	            moveDirection = new Vector3(Input.GetAxis("Horizontal"), 0, Input.GetAxis("Vertical"));
	            moveDirection = transform.TransformDirection(moveDirection);
	            moveDirection *= speed;
	
	            if (Input.GetButton("Jump"))
	            {
	                moveDirection.y = jumpSpeed;
	            }
	        } else {
	        	moveDirection.y -= gravity * Time.deltaTime;
			}
		
			MoveDir = moveDirection.normalized *-1;

            var flags = controller.Move(moveDirection * Time.deltaTime);
            ISGROUNDED = (flags & CollisionFlags.CollidedBelow) != 0;
			//Screen.lockCursor = true;
    }
	
}
